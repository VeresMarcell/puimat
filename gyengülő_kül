
library(ggplot2)
S <- seq(2500,4000,1) # Vector of prices
K1 <- 3400
K2 <- 3300
p_call <- 20 # option price call
p_call_2 <- 30
p_put <- 10  # option price put 

# call option payoff at expiration 

payoffLongCall <- pmax(0,S - K1) +p_call_2-p_call 
payoffLongCall_2 <- pmax(0,S - K2)  

# put option payoff at expiration

# payoffLongPut <- pmax(0,K2 - S) - p_put

# The payoff of the Strategy is the sum of the call and put payoff. Need
# to sum wise element by element between the two vectors
# payoff <- rowSums(cbind(payoffLongCall,payoffLongPut))
payoff <- rowSums(cbind(payoffLongCall,(-1)*payoffLongCall_2))

# Make a DataFrame with all the variable to plot it with ggplot
results <- data.frame(cbind(S,payoffLongCall,payoffLongPut,payoff))

ggplot(results, aes(x=S)) + 
  geom_line(aes(y = payoffLongCall, color = "LongCall")) + 
  geom_line(aes(y = payoffLongCall_2, color="LongPut"))+
  geom_line(aes(y=payoff, color = 'Payoff')) +
  geom_line(aes(y=0, color = "zero")) +
  scale_colour_manual("", 
                      breaks = c("LongCall", "LongPut", "Payoff","zero"),
                      values = c("darkred", "darkblue", "darkgreen","black")) + ylab("Payoff")+
  ggtitle("Long Straddle Payoff")  
