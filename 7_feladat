
library(ggplot2)
S <- seq(2000,4500,1) # Vector of prices
K <- 3400 # strike price for both put and call  (K - kötési ár)
St <- 3550

# call option payoff at expiration 

payoffLongCall <- pmax(0, S - K)
# put option payoff at expiration

payoffLongPut <- pmax(0,K - S)

# The payoff of the Strategy is the sum of the call and put payoff. Need
# to sum wise element by element between the two vectors

payoff <- rowSums(cbind(payoffLongCall,2*payoffLongPut)) # ez az f(St)

# Make a DataFrame with all the variable to plot it with ggplot
results <- data.frame(cbind(S,payoffLongCall,payoffLongPut,payoff))

ggplot(results, aes(x=S)) + 
  geom_line(aes(y = payoffLongCall, color = "LongCall")) + 
  geom_line(aes(y = payoffLongPut, color="LongPut"))+
  geom_line(aes(y=payoff, color = 'Payoff',size=1.5)) +
  geom_line(aes(y=0, color = 'zeroline')) +
  geom_vline(aes(xintercept = St, color = 'Price at T')) +
  scale_colour_manual("", 
                      breaks = c("LongCall", "LongPut", "Payoff","zeroline","Price at T"),
                      values = c("red", "blue", "green","black","orange")) + ylab("Payoff")+
  ggtitle("Bal terpesz stratégia")  
x <- pmax(0,St-K)+2*pmax(0,K-St)
paste("A Kifizetés", St,"esetén:",x)
